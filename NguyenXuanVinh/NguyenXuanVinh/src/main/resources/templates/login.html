<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ÄÄƒng Nháº­p - Mystery Box</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        .login-box { max-width: 400px; margin: 100px auto; padding: 40px; background: #16213e; border-radius: 15px; text-align: center; border: 1px solid #0f3460; }
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; color: #ccc; }
        .form-control { width: 100%; padding: 10px; border-radius: 5px; border: none; background: #0f3460; color: #fff; }
        .btn-submit { width: 100%; padding: 12px; background: #e94560; color: white; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
        .btn-submit:hover { background: #ff2e63; }
        .link { margin-top: 15px; display: block; color: #ffd700; text-decoration: none; }
    </style>
</head>
<body>
<div class="login-box">
    <h2 style="color:#e94560; margin-bottom:30px;">ğŸ ÄÄ‚NG NHáº¬P</h2>
    <div class="form-group">
        <label>TÃªn Ä‘Äƒng nháº­p</label>
        <input type="text" id="username" class="form-control" placeholder="Nháº­p username...">
    </div>
    <div class="form-group">
        <label>Máº­t kháº©u</label>
        <input type="password" id="password" class="form-control" placeholder="Nháº­p máº­t kháº©u...">
    </div>
    <button class="btn-submit" onclick="login()">ÄÄ‚NG NHáº¬P NGAY</button>
    <a href="/register" class="link">ChÆ°a cÃ³ tÃ i khoáº£n? ÄÄƒng kÃ½ ngay</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function login() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

       fetch('/api/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username, password })
            })
            .then(async response => {
                if (response.ok) {
                    const data = await response.json(); // Äá»c JSON tráº£ vá»
                    Swal.fire('ThÃ nh cÃ´ng', 'ChÃ o má»«ng trá»Ÿ láº¡i!', 'success').then(() => {
                        // Äiá»u hÆ°á»›ng dá»±a trÃªn quyá»n
                        if (data.role === 'ADMIN') {
                            window.location.href = '/admin'; // VÃ o trang quáº£n trá»‹
                        } else {
                            window.location.href = '/';      // VÃ o trang chá»§ bÃ¡n hÃ ng
                        }
                    });
                } else {
                    const text = await response.text();
                    Swal.fire('Lá»—i', text, 'error');
                }
            });
    }
</script>
</body>
</html>